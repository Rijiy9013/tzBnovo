
# Guest Management Microservice

## Описание проекта

Этот микросервис реализует API для управления гостями. В сервисе реализованы CRUD операции (создание, чтение, обновление, удаление) для сущности "Гость". Каждый гость имеет уникальный идентификатор (UUID), имя, фамилию, электронную почту, телефон и страну. Телефон и email являются уникальными полями. Если страна не указана, она автоматически определяется по коду телефона.

## Установка и настройка

1. **Установка зависимостей:**

   Выполните команду для установки всех зависимостей:

    ```bash
    composer install
    ```

2. **Создание файла конфигурации:**

   Скопируйте файл `.env.example` в `.env`:

    ```bash
    cp .env.example .env
    ```

   Откройте файл `.env` и настройте параметры подключения к базе данных и другие необходимые переменные окружения.

3. **Запуск миграций:**

   Выполните команду для создания необходимых таблиц в базе данных:

    ```bash
    php artisan migrate
    ```

4. **Запуск сидеров (опционально):**

   Выполните команду для заполнения базы данных начальными данными, такими как коды стран:

    ```bash
    php artisan db:seed --class=PhoneCountryCodesTableSeeder
    ```

5. **Генерация ключа приложения:**

   Выполните команду для генерации ключа приложения:

    ```bash
    php artisan key:generate
    ```

6. **Генерация документации API:**

   Выполните команду для генерации документации Swagger:

    ```bash
    php artisan l5-swagger:generate
    ```

## Запуск проекта

1. **Запуск docker контейнеров:**

   Проект запускается при помощи Docker:

    ```bash
    docker compose up -d --build
    ```

2. **Просмотр документации API:**

   Документация API доступна по адресу: `http://localhost:80/docs`

## API

Все запросы к API должны выполняться с префиксом `/api`. Ниже описаны основные действия с ресурсом `guests`.

### Пример запросов:

1. **Получить список гостей:**

    ```http
    GET /api/guests
    ```

   **Ответ:**

    ```json
    [
        {
            "uuid": "123e4567-e89b-12d3-a456-426614174000",
            "first_name": "John",
            "last_name": "Doe",
            "email": "john.doe@example.com",
            "phone": "+1234567890",
            "country": "USA"
        },
        ...
    ]
    ```

2. **Создать нового гостя:**

    ```http
    POST /api/guests
    ```

   **Тело запроса:**

    ```json
    {
        "first_name": "John",
        "last_name": "Doe",
        "email": "john.doe@example.com",
        "phone": "+1234567890",
        "country": "USA"
    }
    ```

   **Ответ:**

    ```json
    {
        "uuid": "123e4567-e89b-12d3-a456-426614174000",
        "first_name": "John",
        "last_name": "Doe",
        "email": "john.doe@example.com",
        "phone": "+1234567890",
        "country": "USA"
    }
    ```

3. **Получить информацию о госте по UUID:**

    ```http
    GET /api/guests/{uuid}
    ```

   **Ответ:**

    ```json
    {
        "uuid": "123e4567-e89b-12d3-a456-426614174000",
        "first_name": "John",
        "last_name": "Doe",
        "email": "john.doe@example.com",
        "phone": "+1234567890",
        "country": "USA"
    }
    ```

4. **Обновить информацию о госте:**

    ```http
    PUT /api/guests/{uuid}
    ```

   **Тело запроса:**

    ```json
    {
        "first_name": "John",
        "last_name": "Doe",
        "email": "john.doe@example.com",
        "phone": "+1234567890",
        "country": "Canada"
    }
    ```

   **Ответ:**

    ```json
    {
        "uuid": "123e4567-e89b-12d3-a456-426614174000",
        "first_name": "John",
        "last_name": "Doe",
        "email": "john.doe@example.com",
        "phone": "+1234567890",
        "country": "Canada"
    }
    ```

5. **Удалить гостя:**

    ```http
    DELETE /api/guests/{uuid}
    ```

   **Ответ:**

    ```http
    HTTP/1.1 204 No Content
    ```

## Дополнительно

- **Кеширование данных о странах по телефонным кодам:**

  При создании или обновлении гостя страна автоматически определяется на основе телефонного кода. Данные о кодах стран кешируются.
